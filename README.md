## **Всем привет!**

В этом проекте будет представлено множество SQL-запросов, которые призваны продемонстрировать знание языка.

Проект будет находиться в Jupyter Notebook, а все запросы будут написаны на 

![Postgres](https://img.shields.io/badge/postgres-%23316192.svg?style=for-the-badge&logo=postgresql&logoColor=white)

<hr>

## **Задание 1**

Необходимо продемонстрировать знания SQL, решив задания любым доступным способом.

Даны следующие данные: 

Таблица persons - таблица с людьми, относящимися к миру кино:
- id — уникальный идентификатор человека;
- name — имя;
- year_of_birth — год рождения;
- year_of_death — год смерти;
- professions — список профессий.

Таблица titles - таблица с информацией о произведениях (фильмах, сериалах, шоу):
- id — уникальный идентификатор;
- type — тип произведения: фильм, сериал, короткометражка;
- popular_title — популярное название;
- original_title — оригинальное название;
- year_of_start — год выпуска/старта сериала;
- year_of_end — год окончания сериала;
- is_adult — есть ли у фильма ограничение 18+;
- run_time — длительность в минутах;
- genres — жанры, к которым относится произведение.

Таблица ratings - таблица с рейтингами от зрителей:
- title_id — оцениваемое произведение;
- avg_rating — средний рейтинг;
- vote_cnt — количество голосовавших.

Таблица episodes - таблица с эпизодами сериала:
- title_id — ссылка на t itle_id этого эпизода;
- parent_id — ссылка на title_id всего сериала;
- season — номер сезона;
- episode — номер эпизода.

Таблица principals — таблица с людьми, участвовавшими в создании произведений:
- title_id — id произведения;
- ordering — уникальный номер в рамках одного title_id ;
- person_id — id из таблицы persons;
- category — категория работы в рамках произведения;
- job — конкретная работа. Человек может быть автором произведения и в рамках фильма работать над адаптацией текста;
- characters — персонажи, которых играл человек.

<hr>

## **Задание 2**

Необходимо решить три задачи, представляющие собой варианты тестовых заданий на собеседовании.

Даны следующие данные: 

Таблица employees - информация о сотрудниках:

- employee_id - уникальный идентификатор сотрудника;
- name - имя сотрудника;
- manager_id - уникальный идентификатор руководителя сотрудника;

Таблица projects - информация о проектах:

- project_id - уникальный идентификатор проекта; 
- employee_id - уникальный идентификатор сотрудника, который работает над проектом;
- project_name - название проекта;
- hours_worked - количество часов, которое данный сотрудник работает над данным проектом.

<hr>

## **Задание 2**

### Задача 1: 

Необходимо написать оптимальный запрос, который даст информацию о количестве очень усердных студентов. Под усердным студентом мы понимаем студента, который правильно решил 20 задач за текущий месяц.

### Задача 2:

Необходимо в одном запросе выгрузить следующую информацию о группах пользователей:

- ARPU 
- ARPAU 
- CR в покупку 
- СR активного пользователя в покупку 
- CR пользователя из активности по математике (subject = ’math’) в покупку курса по математике

ARPU считается относительно всех пользователей, попавших в группы.

Активным считается пользователь, за все время решивший больше 10 задач правильно в любых дисциплинах. Активным по математике считается пользователь, за все время решивший 2 или больше задач правильно по математике.

Даны следующие данные: 

Таблица peas - информация о решенных задачах:

- st_id - уникальный идентификатор ученика;
- timest - время решения задания;
- correct - правильно ли решена задача;
- subject - дисциплина, в которой находится задача.

Таблица studs - информация о студентах:

- st_id - уникальный идентификатор ученика;
- test_grp - к какой группе принадлежит студент.

Таблица final_project_check - информация о покупках студентов:

- st_id - уникальный идентификатор ученика;
- sale_time - время покупки;
- money - цена покупки;
- subject - дисциплина.
